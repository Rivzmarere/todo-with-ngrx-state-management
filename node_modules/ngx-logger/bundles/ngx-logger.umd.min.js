!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("vlq"),require("rxjs")):"function"==typeof define&&define.amd?define("ngx-logger",["exports","@angular/common","@angular/core","@angular/common/http","rxjs/operators","vlq","rxjs"],t):t((e=e||self)["ngx-logger"]={},e.ng.common,e.ng.core,e.ng.common.http,e.rxjs.operators,e.vlq,e.rxjs)}(this,function(e,t,r,n,o,i,a){"use strict";function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var u=function(){function e(e){this.httpBackend=e}return e.prototype.logOnServer=function(e,t,r){var i=new n.HttpRequest("POST",e,t,r||{});return this.httpBackend.handle(i).pipe(o.filter(function(e){return e instanceof n.HttpResponse}),o.map(function(e){return e.body}))},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:n.HttpBackend}]},e}(),p={TRACE:0,DEBUG:1,INFO:2,LOG:3,WARN:4,ERROR:5,FATAL:6,OFF:7};p[p.TRACE]="TRACE",p[p.DEBUG]="DEBUG",p[p.INFO]="INFO",p[p.LOG]="LOG",p[p.WARN]="WARN",p[p.ERROR]="ERROR",p[p.FATAL]="FATAL",p[p.OFF]="OFF";var l=function(){},g=function(){function e(e){this.config=e,this._config=e}return Object.defineProperty(e.prototype,"level",{get:function(){return this._config.level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverLogLevel",{get:function(){return this._config.serverLogLevel},enumerable:!0,configurable:!0}),e.prototype.updateConfig=function(e){this._config=this._clone(e)},e.prototype.getConfig=function(){return this._clone(this._config)},e.prototype._clone=function(e){var t=new l;return Object.keys(e).forEach(function(r){t[r]=e[r]}),t},e}(),f=["purple","teal","gray","gray","red","red","red"],h=function(){function e(){}return e.prepareMetaString=function(e,t,r,n){return e+" "+t+(r?" ["+r+":"+n+"]":"")},e.getColor=function(e,t){switch(e){case p.TRACE:return this.getColorFromConfig(p.TRACE,t);case p.DEBUG:return this.getColorFromConfig(p.DEBUG,t);case p.INFO:case p.LOG:return this.getColorFromConfig(p.INFO,t);case p.WARN:case p.ERROR:case p.FATAL:return this.getColorFromConfig(p.FATAL,t);case p.OFF:default:return}},e.getColorFromConfig=function(e,t){return t?t[e]:f[e]},e.prepareMessage=function(e){try{"string"==typeof e||e instanceof Error||(e=JSON.stringify(e,null,2))}catch(t){e='The provided "message" value could not be parsed with JSON.stringify().'}return e},e.prepareAdditionalParameters=function(e){return null===e||e===undefined?null:e.map(function(e,t){try{return"object"==typeof e&&JSON.stringify(e),e}catch(r){return"The additional["+t+"] value could not be parsed using JSON.stringify()."}})},e}(),d=function(){function e(e,t,r){this.fileName=e,this.lineNumber=t,this.columnNumber=r}return e.prototype.toString=function(){return this.fileName+":"+this.lineNumber+":"+this.columnNumber},e}(),m=function(){function e(e){this.httpBackend=e,this.sourceMapCache=new Map,this.logPositionCache=new Map}return e.getStackLine=function(e){var t=new Error;try{throw t}catch(n){try{var r=4;return t.stack.split("\n")[0].includes(".js:")||(r+=1),t.stack.split("\n")[r+(e||0)]}catch(n){return null}}},e.getPosition=function(e){var t=e.lastIndexOf("/"),r=e.indexOf(")");r<0&&(r=undefined);var n=e.substring(t+1,r).split(":");return 3===n.length?new d(n[0],+n[1],+n[2]):new d("unknown",0,0)},e.getTranspileLocation=function(e){var t=e.indexOf("(");t<0&&(t=e.lastIndexOf("@"))<0&&(t=e.lastIndexOf(" "));var r=e.indexOf(")");return r<0&&(r=undefined),e.substring(t+1,r)},e.getMapFilePath=function(t){var r=e.getTranspileLocation(t),n=r.substring(0,r.lastIndexOf(":"));return n.substring(0,n.lastIndexOf(":"))+".map"},e.getMapping=function(e,t){for(var r=0,n=0,o=0,a=e.mappings.split(";"),s=0;s<a.length;s++)for(var c=0,u=a[s].split(","),p=0;p<u.length;p++){var l=i.decode(u[p]);if(l.length>=4&&(c+=l[0],r+=l[1],n+=l[2],o+=l[3]),s===t.lineNumber){if(c===t.columnNumber)return new d(e.sources[r],n,o);if(p+1===u.length)return new d(e.sources[r],n,0)}}return new d("unknown",0,0)},e.prototype._getSourceMap=function(t,r){var i=new n.HttpRequest("GET",t),s=r.toString();if(this.logPositionCache.has(s))return this.logPositionCache.get(s);this.sourceMapCache.has(t)||this.sourceMapCache.set(t,this.httpBackend.handle(i).pipe(o.filter(function(e){return e instanceof n.HttpResponse}),o.map(function(e){return e.body}),o.retry(3),o.shareReplay(1)));var c=this.sourceMapCache.get(t).pipe(o.map(function(t){return e.getMapping(t,r)}),o.catchError(function(){return a.of(r)}),o.shareReplay(1));return this.logPositionCache.set(s,c),c},e.prototype.getCallerDetails=function(t,r){var n=this,i=e.getStackLine(r);return i?a.of([e.getPosition(i),e.getMapFilePath(i)]).pipe(o.switchMap(function(e){var r=s(e,2),o=r[0],i=r[1];return t?n._getSourceMap(i,o):a.of(o)})):a.of(new d("",0,0))},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:n.HttpBackend}]},e}(),y=["TRACE","DEBUG","INFO","LOG","WARN","ERROR","FATAL","OFF"],v=function(){function e(e,r,n,o,i){this.mapperService=e,this.httpService=r,this.platformId=o,this.datePipe=i,this._withCredentials=!1,this._isIE=t.isPlatformBrowser(o)&&navigator&&navigator.userAgent&&!(-1===navigator.userAgent.indexOf("MSIE")&&!navigator.userAgent.match(/Trident\//)&&!navigator.userAgent.match(/Edge\//)),this.config=new g(n),this._logFunc=this._isIE?this._logIE.bind(this):this._logModern.bind(this)}return Object.defineProperty(e.prototype,"level",{get:function(){return this.config.level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverLogLevel",{get:function(){return this.config.serverLogLevel},enumerable:!0,configurable:!0}),e.prototype.trace=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.TRACE,e,t)},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.DEBUG,e,t)},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.INFO,e,t)},e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.LOG,e,t)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.WARN,e,t)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.ERROR,e,t)},e.prototype.fatal=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(p.FATAL,e,t)},e.prototype.setCustomHttpHeaders=function(e){this._customHttpHeaders=e},e.prototype.setCustomParams=function(e){this._customParams=e},e.prototype.setWithCredentialsOptionValue=function(e){this._withCredentials=e},e.prototype.registerMonitor=function(e){this._loggerMonitor=e},e.prototype.updateConfig=function(e){this.config.updateConfig(e)},e.prototype.getConfigSnapshot=function(){return this.config.getConfig()},e.prototype._logIE=function(e,t,r,n){switch(n=n||[],e){case p.WARN:console.warn.apply(console,c([t+" ",r],n));break;case p.ERROR:case p.FATAL:console.error.apply(console,c([t+" ",r],n));break;case p.INFO:console.info.apply(console,c([t+" ",r],n));break;default:console.log.apply(console,c([t+" ",r],n))}},e.prototype._logModern=function(e,t,r,n){var o=this.getConfigSnapshot().colorScheme,i=h.getColor(e,o);switch(n=n||[],e){case p.WARN:console.warn.apply(console,c(["%c"+t,"color:"+i,r],n));break;case p.ERROR:case p.FATAL:console.error.apply(console,c(["%c"+t,"color:"+i,r],n));break;case p.INFO:console.info.apply(console,c(["%c"+t,"color:"+i,r],n));break;case p.DEBUG:console.debug.apply(console,c(["%c"+t,"color:"+i,r],n));break;default:console.log.apply(console,c(["%c"+t,"color:"+i,r],n))}},e.prototype._log=function(e,t,r,o){var i=this;void 0===r&&(r=[]),void 0===o&&(o=!0);var a=this.config.getConfig(),s=o&&a.serverLoggingUrl&&e>=a.serverLogLevel,c=e>=a.level;if(t&&(s||c)){var u=y[e];t="function"==typeof t?t():t;var l=h.prepareAdditionalParameters(r),g=a.timestampFormat?this.datePipe.transform(new Date,a.timestampFormat):(new Date).toISOString();this.mapperService.getCallerDetails(a.enableSourceMaps,a.proxiedSteps).subscribe(function(o){var f={message:h.prepareMessage(t),additional:l,level:e,timestamp:g,fileName:o.fileName,lineNumber:o.lineNumber.toString()};if(i._loggerMonitor&&c&&i._loggerMonitor.onLog(f),s){f.message=t instanceof Error?t.stack:t,f.message=h.prepareMessage(f.message);var d=i._customHttpHeaders||new n.HttpHeaders;d.set("Content-Type","application/json");var m={headers:d,params:i._customParams||new n.HttpParams,responseType:a.httpResponseType||"json",withCredentials:i._withCredentials};i.httpService.logOnServer(a.serverLoggingUrl,f,m).subscribe(function(e){},function(e){i._log(p.ERROR,"FAILED TO LOG ON SERVER: "+t,[e],!1)})}if(c&&!a.disableConsoleLogging){var y=h.prepareMetaString(g,u,a.disableFileDetails?null:o.fileName,o.lineNumber.toString());return i._logFunc(e,y,t,r)}})}},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:m},{type:u},{type:l},{type:undefined,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]},{type:t.DatePipe}]},e}(),O=function(){function e(e,t,r,n){this.mapperService=e,this.httpService=t,this.platformId=r,this.datePipe=n}return e.prototype.create=function(e,t,r,n){var o=new v(n||this.mapperService,t||this.httpService,e,this.platformId,this.datePipe);return r&&o.registerMonitor(r),o},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:m},{type:u},{type:undefined,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]},{type:t.DatePipe}]},e}(),b=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:l,useValue:t||{}},v,u,O,m]}},e.forChild=function(){return{ngModule:e,providers:[v,u,O,m]}},e.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule],providers:[v,u,O,m,t.DatePipe]}]}],e}(),R=function(){},C=function(){};e.CustomNGXLoggerService=O,e.DEFAULT_COLOR_SCHEME=f,e.Levels=y,e.LoggerConfig=l,e.LoggerModule=b,e.NGXLogInterface=C,e.NGXLogger=v,e.NGXLoggerHttpService=u,e.NGXLoggerMonitor=R,e.NGXLoggerUtils=h,e.NGXMapperService=m,e.NgxLoggerLevel=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-logger.umd.min.js.map