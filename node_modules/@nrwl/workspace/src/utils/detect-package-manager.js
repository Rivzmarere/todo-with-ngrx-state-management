"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPackageManagerExecuteCommand = exports.detectPackageManager = void 0;
const child_process_1 = require("child_process");
const fileutils_1 = require("./fileutils");
function detectPackageManager() {
    try {
        const output = child_process_1.execSync(`nx config cli.packageManager`, {
            stdio: ['ignore', 'pipe', 'ignore'],
        })
            .toString()
            .trim()
            .split('\n');
        return output[output.length - 1].trim();
    }
    catch (e) {
        return fileutils_1.fileExists('yarn.lock')
            ? 'yarn'
            : fileutils_1.fileExists('pnpm-lock.yaml')
                ? 'pnpm'
                : 'npm';
    }
}
exports.detectPackageManager = detectPackageManager;
function getPackageManagerExecuteCommand(packageManager = detectPackageManager()) {
    if (packageManager === 'yarn') {
        return `yarn`;
    }
    if (packageManager === 'pnpm') {
        return `pnpx`;
    }
    return `npx`;
}
exports.getPackageManagerExecuteCommand = getPackageManagerExecuteCommand;
//# sourceMappingURL=detect-package-manager.js.map